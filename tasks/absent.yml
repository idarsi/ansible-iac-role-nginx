---
###############################################################################
#
# absent.yml
#
# @author Arsi Atomi
#
###############################################################################

###############################################################################
# SETTING VARIABLES
###############################################################################



###############################################################################
# ENSURING SERVICE IS STOPPED
###############################################################################

- name: "Ensuring nginx service is stopped"
  ansible.builtin.include_tasks: stopped.yml

###############################################################################
# ENSURING CRONJOB CONFIGURATION
###############################################################################

- name: "Ensuring cron configuration is absent"
  ansible.builtin.include_tasks: cron_absent.yml
  when: iac_blueprint.nginx.cron is defined
  vars:
    iac_cron: "{{ iac_blueprint.nginx.cron | default([]) }}"

###############################################################################
# ENSURING FILESYSTEM CONFIGURATION
###############################################################################

- name: "Ensuring filesystem configuration is absent"
  ansible.builtin.include_tasks: fs_absent.yml
  when: iac_blueprint.nginx.directories is defined
  vars:
    iac_fs_directories: "{{ iac_blueprint.nginx.directories | default([]) }}"
    iac_fs_files: "{{ iac_blueprint.nginx.files | default([]) }}"

###############################################################################
# ENSURING NGINX PACKAGE IS ABSENT
###############################################################################

- name: "Ensuring nginx is installed"
  ansible.builtin.include_tasks: package_absent.yml
  vars:
    iac_package: "nginx"

###############################################################################
# ENSURING REPOSITORIES ARE PRESENT
###############################################################################

- name: "Ensuring Nginx repositories are present"
  ansible.builtin.include_tasks: repo_present.yml
